# スキル: スライドデザイン原則（美しいビジネス提案書）

> **使い方**: ビジュアル評価・設計時にこのファイルを読む。通常の生成作業では不要。

---

## 0. 全要素共通の基本原則（ここを守るだけで質が上がる）

### テキスト視認性の絶対ルール
| 用途 | 最小フォントサイズ | 推奨 |
|---|---|---|
| ボックス内ラベル（1行） | 11pt | 12〜14pt |
| ボックス内2行テキスト | 10pt | 11〜12pt |
| 補足テキストボックス | 10pt | 11pt |
| body（箇条書き） | テンプレート依存（変更しない）| — |

**コントラスト**: 白文字は `fill_color` が暗い色のみ（`C00000`, `4472C4`, `404040`）。
明るい背景（`FFFFFF`, `F2F2F2`）に白文字は使わない。

### ボックスの高さ設計（詰め込み厳禁）
```
1行テキスト → height: 0.7〜0.8
2行テキスト → height: 1.0〜1.2
3行テキスト → height: 1.4〜1.6

height が小さすぎるとテキストが切れる・上部に偏る
特に日本語は英語より行間が必要 → 1行あたり 0.5インチを目安に
```

### 余白・マージンの基本値
```
スライド端からの最小距離:
  左端: left ≥ 0.5インチ
  右端: left + width ≤ 12.8インチ
  上端（コンテンツ）: top ≥ 1.5インチ（テンプレートのタイトルバー分）
  下端: top + height ≤ 6.8インチ（フッター前）

要素間のギャップ:
  ボックス同士: 0.2〜0.4インチ（詰めすぎない）
  ボックスと画像: 0.4インチ以上
  矢印の幅: 0.4〜0.6インチ（細すぎると見えない）
```

### センタリングとアライメントのルール
1. **ボックス内テキスト**: 常に水平中央揃え（コードが `PP_ALIGN.CENTER` で設定済み）
2. **複数ボックスを並べる場合**: 全ボックスの `top` を揃える（垂直位置を統一）
3. **矢印の垂直位置**: ボックスの `top + height/2 - 矢印height/2`
   - ボックス `top=4.3, height=1.0` → 矢印 `top = 4.3 + 0.5 - 0.25 = 4.55`
4. **画像の垂直位置**: 可能な限り body テキストの上端（top: 1.5〜2.0）に揃える

### 全体バランスのチェック
- **左右の視覚的重さを揃える**: 左にテキストが多い → 右に画像で均衡を取る
- **大きな空白を作らない**: 右下や左下に何もない象限があれば要素を再配置
- **要素を詰めすぎない**: 全体の 20% は余白であるべき

---

## 1. 情報密度の黄金律

### 1スライド1メッセージ
- 1スライドで伝えることは**1つだけ**
- タイトルに「何を言いたいか」が凝縮されているか確認
- 本文はタイトルの証拠・補足であるべき

### 文字量の目安（1行30-50文字）
| 要素 | 最大文字数 | 備考 |
|---|---|---|
| スライドタイトル | 25〜35文字 | 短すぎ/長すぎ両方NG |
| キーメッセージ | 40〜70文字 | 体言止めか動詞終止 |
| 箇条書き1項目 | 30〜50文字 | 体言止め推奨 |
| 箇条書き項目数 | 3〜5項目 | 6項目以上は分割検討 |

---

## 2. カラーパレット規律

### SXテンプレートの推奨色
| 用途 | カラーコード | 使用場面 |
|---|---|---|
| 主張・強調 | `C00000`（深紅） | 課題・リスク・現状NG |
| 提案・解決 | `4472C4`（青） | 提案・目標・将来 |
| アクセント | `ED7D31`（橙） | 矢印・遷移・変化のみ |
| 補足・中立 | `404040`（濃グレー） | 補足テキスト・ニュートラル要素 |
| 背景白抜き | `FFFFFF`（白） | 囲み・ラベル（テキスト色を黒に） |

### 基本方針: 色を使わないことも正解

**1スライドに使う fill_color の種類は最大2色。矢印の橙は「色数に数えない」扱いでよい。**

```
OK: 全カード同色（青のみ）      → 統一感・安心感
OK: 赤 + 青（対比）             → 課題→解決の強調
OK: 青 + グレー                 → メイン + サブの区別
NG: 赤 + 青 + 緑 + 橙           → 視線が分散、安っぽく見える
NG: 3枚のカードが全部違う色      → 優劣がないのに差があると誤解される
```

### 色の意味を守る（意味的一貫性）

| 色 | 意味 | 使ってよい場面 | 使ってはいけない場面 |
|---|---|---|---|
| `C00000` 赤 | 問題・警告・現状の課題 | 課題ボックス・Before | 解決策・未来像 |
| `4472C4` 青 | 解決・提案・目標 | 提案ボックス・After・カード並列 | 課題・リスク |
| `ED7D31` 橙 | 遷移・変化・矢印 | 矢印のみ | メインのボックス（装飾過多になる） |
| `404040` 濃グレー | 中立・補足・階層下 | サブ情報・フォルダ構造 | 強調したい要素 |

### 状況別カラー選択ガイド

**並列（3つとも同等価値）→ 全部同じ青**
```json
{"fill_color": "4472C4"}, {"fill_color": "4472C4"}, {"fill_color": "4472C4"}
```

**Before/After（対比）→ 赤 + 青**
```json
{"fill_color": "C00000"},  // Before（課題）
{"fill_color": "ED7D31"},  // arrow（矢印は橙）
{"fill_color": "4472C4"}   // After（解決）
```

**段階・フェーズ（軽重をつけたい）→ 青 + グレー**
```json
{"fill_color": "4472C4"},  // 現在フェーズ（強調）
{"fill_color": "404040"},  // 完了フェーズ（落ち着いた色）
{"fill_color": "4472C4"}   // 次フェーズ（強調）
```

**3段階の重要度差がある場合 → 深青・中青・薄青**
```json
// 単色の濃淡で表現（SXパレット外だが許容範囲）
{"fill_color": "1F3864"},  // 最重要（濃紺）
{"fill_color": "4472C4"},  // 重要（青）
{"fill_color": "8FAADC"}   // 参考（薄青）
```

---

## 3. レイアウトゾーン設計（最重要）

### スライドの座標空間
```
幅: 13.3インチ  高さ: 7.5インチ
コンテンツエリア: top 1.5〜7.0（テンプレートタイトルバー除く）
左半分: left 0.0〜6.6
右半分: left 6.6〜13.3
```

### 要素の共存ルール（混在時の最重要原則）

**body + objects + images の3要素を同時に使うと必ず崩れる。以下のパターンから選ぶ。**

| パターン | body | objects | images | 使いどころ |
|---|---|---|---|---|
| A: テキスト＋画像 | あり（左） | なし | あり（右） | 説明・分析系スライド |
| B: 図解＋画像 | なし | あり（左） | あり（右） | 3要素並列・比較系 |
| C: テキスト＋図解 | あり（上） | あり（下） | なし | フロー・遷移型 |
| D: 全幅図解 | なし | あり（全幅） | なし | カード型・分類型 |

---

## 4. 図解パターン集（objects設計）

### パターンC: 現状→提案型（body上部 + objects下部）
body: `top: 1.5〜3.5`（テキスト）、objects: `top: 4.2〜5.4`
```json
"body": "・課題1\n・課題2\n・課題3",
"objects": [
  {"type":"box","text":"現状\n○○","left":0.5,"top":4.2,"width":2.8,"height":1.0,"fill_color":"C00000","font_color":"FFFFFF","font_size":12},
  {"type":"arrow","left":3.4,"top":4.55,"width":0.6,"height":0.5,"fill_color":"ED7D31"},
  {"type":"box","text":"提案後\n○○","left":4.1,"top":4.2,"width":2.8,"height":1.0,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12}
]
```
**注意**: images は使わない（3要素共存の回避）

---

### パターンD: 全幅3カード（body なし・images なし）
3つの等価な要素を全幅で並べる。`width = (12.8 - 0.5 - 0.2*2) / 3 ≈ 4.0`
```json
"objects": [
  {"type":"box","text":"項目1\n説明","left":0.5, "top":3.5,"width":3.9,"height":1.5,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12},
  {"type":"box","text":"項目2\n説明","left":4.6, "top":3.5,"width":3.9,"height":1.5,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12},
  {"type":"box","text":"項目3\n説明","left":8.7, "top":3.5,"width":3.9,"height":1.5,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12}
]
```
`left[1] = left[0] + width + gap = 0.5 + 3.9 + 0.2 = 4.6`
`left[2] = left[1] + width + gap = 4.6 + 3.9 + 0.2 = 8.7`

---

### パターンB: 3カード＋右画像（objects左側・image右側）
```json
"objects": [
  {"type":"box","text":"項目1\n説明","left":0.5,"top":3.5,"width":2.1,"height":1.5,"fill_color":"4472C4","font_color":"FFFFFF","font_size":11},
  {"type":"box","text":"項目2\n説明","left":2.8,"top":3.5,"width":2.1,"height":1.5,"fill_color":"4472C4","font_color":"FFFFFF","font_size":11},
  {"type":"box","text":"項目3\n説明","left":5.1,"top":3.5,"width":2.1,"height":1.5,"fill_color":"4472C4","font_color":"FFFFFF","font_size":11}
],
"images": [
  {"prompt":"...", "model":"gemini-3-pro-image-preview","left":7.6,"top":1.8,"width":5.3}
]
```
objects が `left: 0.5〜7.2` に収まり、image が `left: 7.6〜12.9` に収まる → 隙間なし

---

### パターンA: テキスト＋右画像（objects なし）
```json
"body": "・説明1（左側に収まる文字数）\n・説明2\n・説明3\n・説明4",
"images": [
  {"prompt":"...", "model":"gemini-3-pro-image-preview","left":7.5,"top":1.8,"width":5.3}
]
```
左側テキスト、右側画像の最もシンプルな構成。

---

### フェーズ図（3ステップ）: パターンC の変形
```json
"objects": [
  {"type":"box","text":"Phase 1\n調査","left":0.5,"top":4.3,"width":2.5,"height":1.0,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12},
  {"type":"arrow","left":3.1,"top":4.55,"width":0.5,"height":0.5,"fill_color":"ED7D31"},
  {"type":"box","text":"Phase 2\n設計","left":3.7,"top":4.3,"width":2.5,"height":1.0,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12},
  {"type":"arrow","left":6.3,"top":4.55,"width":0.5,"height":0.5,"fill_color":"ED7D31"},
  {"type":"box","text":"Phase 3\n実装","left":6.9,"top":4.3,"width":2.5,"height":1.0,"fill_color":"4472C4","font_color":"FFFFFF","font_size":12}
]
```

---

## 5. objects 座標計算テンプレート

### N個の等幅ボックスを均等配置する計算式
```
スライド幅: 13.3インチ
使用可能幅: 12.8インチ（左マージン 0.5）
ボックス幅 = (12.8 - 0.5*(N-1)) / N  ← ギャップ0.5インチの場合

N=2:  width = 6.15  left[0]=0.5  left[1]=7.15
N=3:  width = 3.93  left[0]=0.5  left[1]=4.93  left[2]=9.37 ※または width=4.0 gap=0.2で綺麗
N=4:  width = 2.95  left[0]=0.5  left[1]=3.95  left[2]=7.4  left[3]=10.85

# width=4.0, gap=0.2 の 3ボックス（推奨）
left[0]=0.5  left[1]=4.7  left[2]=8.9
```

### 画像エリアと objects の衝突回避
- objects の `left + width` の最大値 < images の `left` となるよう設計
- 例: objects最右端 = 5.1 + 2.1 = 7.2 → images left = 7.6（0.4インチのバッファ）

---

## 6. 画像配置ガイドライン

### contentスライドの画像エリア
- **右半分推奨**: `left: 7.5〜8.0`, `top: 1.5〜2.0`, `width: 5.0〜5.5`
- 本文（左側）と画像（右側）で視線を分離する
- 画像がある場合、本文の箇条書きは左側3〜4項目に絞る

### objects と画像が共存する場合（パターンB）
- objects の x 範囲: `left: 0.5 〜 7.2`（全幅の54%）
- images の x 範囲: `left: 7.6 〜 12.9`（全幅の40%）
- objects の高さは `height: 1.2〜2.0` に設定（本文エリアをフル活用）

### 画像プロンプト品質基準
- **英語で記述**（Geminiの品質向上）
- スライドの内容と直接関連させる
- スタイル指定を含める: `clean minimal business illustration`, `flat design`, `professional`
- NGワード: `photo`, `realistic` (ベクター系の方がスライドに馴染む)

---

## 7. スライド種別ごとの設計指針

| type | 目的 | 推奨パターン |
|---|---|---|
| `title` | 第一印象・権威付け | シンプルに。タイトルとサブタイトル（日付・宛先）のみ |
| `agenda` | 全体像の提示 | 章番号＋章名のみ。1行1章 |
| `chapter` | 章の区切り | 短く力強いタイトルのみ。写真なし（ミニマル） |
| `chapter_photo` | 章の区切り（写真あり） | 視覚インパクト重視の章扉 |
| `content` | 主張・証拠 | A/B/C/Dパターンから1つ選ぶ。3要素共存は禁止 |
| `end` | 締め・次のアクション | 「ご清聴ありがとうございました」系。シンプルに |

---

## 8. アンチパターン（やってはいけないこと）

- **並列カードを全部違う色にする**: 等価な要素に色差をつけると優劣があると誤解される。並列は同色統一
- **橙色をボックスに使う**: `ED7D31` は矢印専用。メインボックスを橙にするとポップすぎてビジネス感が失われる
- **1スライドに3色以上のfill_color**: 視線が散漫になる。2色（または1色）でまとめる
- **body + objects + images を全部使う**: レイアウト崩壊の最大原因。必ずパターンA/B/C/Dから選ぶ
- **objects が左端に偏る**: 右半分に空白が残り間抜けに見える。全幅レイアウトに直す
- **3ボックスの left 計算が甘い**: `0.5, 3.2, 5.9` のように詰まると右端に大きな空白。計算式で確認
- **ボックスの height が小さすぎる**: テキストが切れる・垂直位置がおかしくなる。1行=0.8、2行=1.2
- **矢印の top がボックスと合っていない**: `top = ボックスtop + ボックスheight/2 - 矢印height/2` で計算する
- **複数ボックスの top がバラバラ**: 並列ボックスは同じ top 値に揃える
- **箇条書きを読むだけのスライド**: 聴衆は読めるが、話す意味がない
- **フォント色が白×白**: 背景と同化して見えない
- **図解なしの content**: 最低1つの objects か images を入れる
- **画像が左側にある**: 日本語は左から読むため、テキスト左・画像右が基本
- **タイトルが体言止めでない**: 「〜について」は弱い。「〜で○○を実現する」が強い

---

## 9. セルフチェックリスト（Tier 2 生成前に確認）

**基本原則（全要素共通）**
- [ ] ボックスの height は 1行=0.8、2行=1.2 以上か？
- [ ] 矢印の top = `ボックスtop + height/2 - 矢印height/2` で計算したか？
- [ ] 並列ボックスの top は全て揃っているか？
- [ ] フォントサイズは 10pt 以上か（2行以上なら11pt以上）？
- [ ] 白文字を使う場合、背景が十分暗いか？

**レイアウト（配置）**
- [ ] body/objects/images の3要素を同時に使っていないか？（A/B/C/Dパターンを選択したか）
- [ ] objects の right端（left+width）が 12.8インチ以内か？
- [ ] N個のボックスを均等幅で配置しているか（計算式を使ったか）？
- [ ] objects と images の x 座標が 0.4インチ以上の隙間を保っているか？
- [ ] 右下や左下に大きな空白の象限がないか？

**内容**
- [ ] 1スライドのメッセージが1つに絞られているか？
- [ ] タイトルが「〜で○○を実現する」形式（体言止め or 動詞終止）か？
