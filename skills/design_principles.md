# スキル: スライドデザイン原則（全テンプレート共通）

> **使い方**: ビジュアル評価・設計時にこのファイルを読む。通常の生成作業では不要。
> テンプレート固有の座標・色コード・レイアウトは `templates/<id>/design_guide.md` を参照。

---

## 0. 全要素共通の基本原則（ここを守るだけで質が上がる）

### テキスト視認性の絶対ルール
| 用途 | 最小フォントサイズ | 推奨 |
|---|---|---|
| ボックス内ラベル（1行） | 11pt | 12〜14pt |
| ボックス内2行テキスト | 10pt | 11〜12pt |
| 補足テキストボックス | 10pt | 11pt |
| body（箇条書き） | テンプレート依存（変更しない）| — |

**コントラスト**: 白文字は `fill_color` が暗い色のみ（テンプレートの primary/secondary/neutral 色）。
明るい背景に白文字は使わない。

### ボックスの高さ設計（詰め込み厳禁）
```
1行テキスト → height: 0.7〜0.8
2行テキスト → height: 1.0〜1.2
3行テキスト → height: 1.4〜1.6

height が小さすぎるとテキストが切れる・上部に偏る
特に日本語は英語より行間が必要 → 1行あたり 0.5インチを目安に
```

### 余白・マージンの基本値
```
テンプレートの content_area を参照（profile.json に定義）:
  左端: left ≥ content_area.left
  右端: left + width ≤ content_area.right
  上端: top ≥ content_area.top（テンプレートのタイトルバー分）
  下端: top + height ≤ content_area.bottom（フッター前）

要素間のギャップ:
  ボックス同士: 0.2〜0.4インチ（詰めすぎない）
  ボックスと画像: 0.4インチ以上
  矢印の幅: 0.4〜0.6インチ（細すぎると見えない）
```

### センタリングとアライメントのルール
1. **ボックス内テキスト**: 常に水平中央揃え
2. **複数ボックスを並べる場合**: 全ボックスの `top` を揃える（垂直位置を統一）
3. **矢印の垂直位置**: `top = ボックスtop + ボックスheight/2 - 矢印height/2`
4. **画像の垂直位置**: 可能な限り body テキストの上端に揃える

### 全体バランスのチェック
- **左右の視覚的重さを揃える**: 左にテキストが多い → 右に画像で均衡を取る
- **大きな空白を作らない**: 右下や左下に何もない象限があれば要素を再配置
- **要素を詰めすぎない**: 全体の 20% は余白であるべき

---

## 1. 情報密度の黄金律

### 1スライド1メッセージ
- 1スライドで伝えることは**1つだけ**
- タイトルに「何を言いたいか」が凝縮されているか確認
- 本文はタイトルの証拠・補足であるべき

### 文字量の目安（1行30-50文字）
| 要素 | 最大文字数 | 備考 |
|---|---|---|
| スライドタイトル | 25〜35文字 | 短すぎ/長すぎ両方NG |
| キーメッセージ | 40〜70文字 | 体言止めか動詞終止 |
| 箇条書き1項目 | 30〜50文字 | 体言止め推奨 |
| 箇条書き項目数 | 3〜5項目 | 6項目以上は分割検討 |

---

## 2. カラーパレット規律

> 具体的な色コードはテンプレートの design_guide.md を参照。ここでは原則のみ。

### 基本方針: 色を使わないことも正解

**1スライドに使う fill_color の種類は最大2色。矢印のアクセント色は「色数に数えない」扱いでよい。**

```
OK: 全カード同色（secondary のみ）→ 統一感・安心感
OK: primary + secondary（対比）   → 課題→解決の強調
OK: secondary + neutral           → メイン + サブの区別
NG: 3色以上のfill_color           → 視線が分散、安っぽく見える
NG: 3枚のカードが全部違う色       → 優劣がないのに差があると誤解される
```

### 色の意味を守る（意味的一貫性）

| セマンティック名 | 意味 | 使ってよい場面 | 使ってはいけない場面 |
|---|---|---|---|
| primary | 問題・警告・現状の課題 | 課題ボックス・Before | 解決策・未来像 |
| secondary | 解決・提案・目標 | 提案ボックス・After・カード並列 | 課題・リスク |
| accent | 遷移・変化 | 矢印のみ | メインのボックス（装飾過多になる）|
| neutral | 中立・補足 | サブ情報・フォルダ構造 | 強調したい要素 |

### 状況別カラー選択ガイド

```
並列（3つとも同等価値）→ 全部 secondary
Before/After（対比）   → primary → accent(矢印) → secondary
段階・フェーズ         → secondary（強調）+ neutral（落ち着き）
3段階の重要度差        → 濃い secondary → secondary → 薄い secondary
```

---

## 3. レイアウトゾーン設計（最重要）

> 具体的な座標値はテンプレートの design_guide.md 参照。

### 要素の共存ルール（混在時の最重要原則）

**body + objects + images の3要素を同時に使うと必ず崩れる。以下のパターンから選ぶ。**

| パターン | body | objects | images | 使いどころ |
|---|---|---|---|---|
| A: テキスト＋画像 | あり（左） | なし | あり（右） | 説明・分析系スライド |
| B: 図解＋画像 | なし | あり（左） | あり（右） | 3要素並列・比較系 |
| C: テキスト＋図解 | あり（上） | あり（下） | なし | フロー・遷移型 |
| D: 全幅図解 | なし | あり（全幅） | なし | カード型・分類型 |

---

## 4. 図解パターン集（objects設計）

> 具体的座標はテンプレートの design_guide.md 参照。ここでは構造パターンを示す。

### パターンC: 現状→提案型（body上部 + objects下部）
body はコンテンツエリア上部、objects はコンテンツエリア下部に配置。
```
body: top = content_area.top（テンプレート自動配置）
objects: top = コンテンツエリアの下半分

[primary] → [accent 矢印] → [secondary]
```

### パターンD: 全幅Nカード（body なし・images なし）
N個の等価な要素を全幅で均等配置。
```
available_width = content_area.right - content_area.left
box_width = (available_width - gap * (N-1)) / N
left[i] = content_area.left + i * (box_width + gap)
```

### パターンB: Nカード + 右画像
objects を左側に配置、images を右側に配置。
```
objects 範囲: content_area.left 〜 slide_width * 0.55
images 範囲: slide_width * 0.58 〜 content_area.right
```

### パターンA: テキスト + 右画像
body（左側テキスト）+ images（右側画像）の最もシンプルな構成。

### フェーズ図（3ステップ）: パターンC の変形
```
[Phase 1] → [矢印] → [Phase 2] → [矢印] → [Phase 3]
全ボックス同色（secondary）、矢印は accent
```

---

## 5. objects 座標計算テンプレート

### N個の等幅ボックスを均等配置する計算式
```
available_width = content_area.right - content_area.left
gap = 0.2  # ボックス間の隙間（インチ）
box_width = (available_width - gap * (N-1)) / N

left[0] = content_area.left
left[i] = left[0] + i * (box_width + gap)
```

### 画像エリアと objects の衝突回避
- objects の `left + width` の最大値 < images の `left` - 0.4
- 重ならないように 0.4インチ以上のバッファを確保

---

## 6. 画像配置ガイドライン

### contentスライドの画像エリア
- **右半分推奨**: スライド幅の 57〜60% の位置から配置開始
- 本文（左側）と画像（右側）で視線を分離する
- 画像がある場合、本文の箇条書きは左側3〜4項目に絞る

### objects と画像が共存する場合（パターンB）
- objects の x 範囲: 全幅の左 55%
- images の x 範囲: 全幅の右 40%

### 画像プロンプト品質基準
- **英語で記述**（Geminiの品質向上）
- スライドの内容と直接関連させる

#### スライド種別による画像スタイルの使い分け

| スライド種別 | 推奨スタイル |
|---|---|
| title / agenda / chapter_photo / end | **実写風プロ写真**（テンプレートの大面積画像エリアに映える）|
| content（説明・分析系） | **フラットイラスト**（小さめ画像エリアに適切）|

#### 画像の再利用（統一感の鉄則）
- 表紙(title)と目次(agenda)は**同じ画像を使う**のがコンサル提案書の基本
- `"file": "images/xxx.png"` で生成済み画像を再利用する
- 章扉(chapter_photo)も同じテーマの写真を使うと全体に統一感が出る
- 毎スライドで違う画像にしない（バラバラ感が出る）

---

## 7. スライド種別ごとの設計指針

| type | 目的 | 推奨パターン |
|---|---|---|
| `title` | 第一印象・権威付け | タイトル＋サブタイトル（`会社名\n日付`の2行）のみ。実写風写真推奨 |
| `agenda` | 全体像の提示 | タイトルは**「アジェンダ」**（「目次」ではない）。階層構造可。表紙と同じ画像を再利用 |
| `chapter` | 章の区切り | 短く力強いタイトルのみ。写真なし（ミニマル） |
| `chapter_photo` | 章の区切り（写真あり） | 視覚インパクト重視の章扉 |
| `content` | 主張・証拠 | A/B/C/Dパターンから1つ選ぶ。3要素共存は禁止 |
| `end` | 締め・次のアクション | 「ご清聴ありがとうございました」系。シンプルに |

---

## 8. アンチパターン（やってはいけないこと）

- **並列カードを全部違う色にする**: 等価な要素に色差をつけると優劣があると誤解される。並列は同色統一
- **accent色をボックスに使う**: accent は矢印専用。メインボックスに使うとポップすぎてビジネス感が失われる
- **1スライドに3色以上のfill_color**: 視線が散漫になる。2色（または1色）でまとめる
- **body + objects + images を全部使う**: レイアウト崩壊の最大原因。必ずパターンA/B/C/Dから選ぶ
- **objects が左端に偏る**: 右半分に空白が残り間抜けに見える。全幅レイアウトに直す
- **Nボックスの left 計算が甘い**: 計算式を使って等間隔に配置する
- **ボックスの height が小さすぎる**: テキストが切れる。1行=0.8、2行=1.2
- **矢印の top がボックスと合っていない**: `top = ボックスtop + ボックスheight/2 - 矢印height/2` で計算する
- **複数ボックスの top がバラバラ**: 並列ボックスは同じ top 値に揃える
- **箇条書きを読むだけのスライド**: 聴衆は読めるが、話す意味がない
- **図解なしの content**: 最低1つの objects か images を入れる
- **画像が左側にある**: テキスト左・画像右が基本
- **タイトルが体言止めでない**: 「〜について」は弱い。「〜で○○を実現する」が強い

---

## 9. ノンデザイナーズ・デザインブック CRAP 原則の応用

> 名著「ノンデザイナーズ・デザインブック」の4原則をスライドJSON設計に落とし込む。
> 出典: ロビン・ウィリアムズ著。近接・整列・反復・コントラストの頭文字。

---

### C -- Contrast（コントラスト）: 「違うなら、はっきり違わせる」

**原則**: 要素に差をつけるなら、曖昧でなく明確に差をつける。半端な違いは「間違い」に見える。

| 状況 | 悪い例 | 良い例 |
|---|---|---|
| 課題 vs 解決 | ほぼ同じ色（微妙な差） | primary（赤系）vs secondary（青系）|
| 強調 vs 補足 | height差が微妙 | height: 0.8 vs 1.2（面積で差をつける）|
| 現在 vs 完了 | 全部同じ色 | secondary（強調）vs neutral（落ち着き）|

---

### R -- Repetition（反復）: 「デザイン要素をくり返し使う」

**原則**: 同じ意味の要素は同じ見た目にする。デッキ全体を通じてデザインを統一する。

- **同じ役割のボックスは同じスタイル**: 全スライドで「課題ボックス = primary, height=0.8, font_size=12」を一貫
- **矢印は常に同じスタイル**: accent色、width=0.5, height=0.5
- **章扉は全て同じ type**: `chapter` or `chapter_photo` を混在させない
- **カードのラベルパターンを統一**: 「1行目=タイトル + 改行 + 2行目=説明」を全カードで揃える

**アンチパターン**: 1枚目は height:0.8、2枚目は height:1.0 → 統一感がない

---

### A -- Alignment（整列）: 「すべての要素を意図的に配置する」

**原則**: ページ上のすべての要素は他の要素と視覚的につながりを持つべき。「なんとなく配置」はしない。

1. **並列ボックスの `top` は必ず同値**
2. **左端は content_area.left に揃える（スライドのグリッド基点）**
3. **画像の `top` はコンテンツ上端に揃える**
4. **矢印の `top` は隣接ボックスの垂直中心に揃える**: `arrow.top = box.top + box.height/2 - arrow.height/2`
5. **N個の均等ボックスは計算式で正確に配置**: 目分量は禁止

---

### P -- Proximity（近接）: 「関係するものをグループ化する」

**原則**: 関連する要素は近くに置き、無関係な要素は離す。

1. **フローの「箱→矢印→箱」はギャップを均等に**: 0.1〜0.3インチ
2. **グループ間には空白を設ける**: 0.5インチ以上
3. **孤立した要素を作らない**: 画像・テキストボックスがスライドの片隅に浮いていないか確認
4. **bodyとobjectsの垂直分離**: body（上半分）と objects（下半分）の間に 0.5インチ以上の空白

---

### CRAP 原則チェック（スライド1枚の最終確認）

| 原則 | 確認内容 |
|---|---|
| **C: コントラスト** | 対比要素の色・サイズ差が「明確」か？半端な差になっていないか？ |
| **R: 反復** | 同じ役割のボックスは全て同じ `height`, `font_size`, `fill_color` を使っているか？ |
| **A: 整列** | 並列ボックスの `top` が揃っているか？ `left` が計算式に基づいているか？ |
| **P: 近接** | 関連要素はグループ化されているか？孤立した要素がないか？ |

---

## 10. コンサル流スライド設計原則（意思決定を促す構造化）

> コンサルのスライド作成は「資料作り」ではなく**「意思決定を促すための構造化」**そのもの。

---

### 基本構成の3原則

#### 1. 1枚1メッセージ（One Slide, One Message）
スライドの `title` と `subtitle` を読むだけで結論が分かる状態にする。

| 弱い例 | 強い例 |
|---|---|
| 「現状の課題について」 | 「属人化が原因で、品質・スピードが共に低下している」 |
| 「提案内容」 | 「AI活用により月40時間の削減と品質標準化を同時に実現できる」 |
| 「スケジュール概要」 | 「3フェーズ計6ヶ月で段階移行し、リスクを最小化する」 |

→ `subtitle`（キーメッセージ欄）に「〜なので、〇〇すべきである」という主張を必ず書く

#### 2. メッセージライン（逆三角形の構造）
```
[タイトル] ← 何のスライドか
[サブタイトル/キーメッセージ] ← 結論・主張（ここを読めば中身を見なくていい）
────────────────────────────────
[body/objects/images] ← 根拠・データ・図解（上の主張を支える証拠）
```

#### 3. タイトルだけ読めばストーリーが繋がる
全スライドの `title` を並べたとき、それだけでプレゼンのナラティブが分かるか確認する。

---

### 推奨パターン（コンサルの代表的な型）

| パターン | 使いどころ | objects 設計のヒント |
|---|---|---|
| **空・雨・傘** | 事実→解釈→アクションの論理展開 | 3ボックス（neutral→neutral→secondary）+ 矢印 |
| **比較テーブル** | 複数案の評価・推奨案の選定 | text オブジェクトで行列構造を再現 |
| **プロセス図** | 業務フロー・ロードマップ | フェーズボックス + 右矢印の連鎖 |
| **マトリクス（4象限）** | 優先順位の可視化 | 4ボックス、背景色で象限を分ける |
| **Before/After** | 現状課題→改善後の対比 | primary→accent矢印→secondary |

---

### アンチパターン（コンサル品質を下げる典型ミス）

| アンチパターン | 症状 | 対処法 |
|---|---|---|
| **「何でも載せ」症候群** | body に5項目以上、objects に4個以上 | 1スライドで伝えることを1つに絞る |
| **「で、何？」の欠如** | 図解だけあって示唆がない | `subtitle` に必ず「〜であるため、〇〇すべき」 |
| **タイトルが名詞句のみ** | 「現状分析」「提案内容」だけ | 「〜により、〇〇を実現できる」と言い切る |
| **定性的な表現のみ** | 「大幅に改善」 | 「30%削減」「月40時間短縮」と定量化する |
| **デコレーション過多** | 3色以上、グラデーション、影 | fill_color は2種類まで。装飾より余白 |

---

### メッセージライン品質チェック

`subtitle`（キーメッセージ）を書く際の強さの段階:
```
レベル1（弱）: 「AIを活用した業務改善について」          ← 名詞句。主張なし
レベル2      : 「AIを活用することで業務改善が可能です」   ← 主張あり、定量なし
レベル3（強）: 「AI導入により月40時間・30%のコスト削減が実現できる」 ← 定量 + 主張
```

目指すのは**レベル3**。数字・主語・動詞を全て含む言い切り型。

---

## 11. セルフチェックリスト（Tier 2 生成前に確認）

**基本原則（全要素共通）**
- [ ] ボックスの height は 1行=0.8、2行=1.2 以上か？
- [ ] 矢印の top = `ボックスtop + height/2 - 矢印height/2` で計算したか？
- [ ] 並列ボックスの top は全て揃っているか？
- [ ] フォントサイズは 10pt 以上か（2行以上なら11pt以上）？
- [ ] 白文字を使う場合、背景が十分暗いか？

**レイアウト（配置）**
- [ ] body/objects/images の3要素を同時に使っていないか？（A/B/C/Dパターンを選択したか）
- [ ] objects の right端（left+width）が content_area.right 以内か？
- [ ] N個のボックスを均等幅で配置しているか（計算式を使ったか）？
- [ ] objects と images の x 座標が 0.4インチ以上の隙間を保っているか？
- [ ] 右下や左下に大きな空白の象限がないか？

**内容**
- [ ] 1スライドのメッセージが1つに絞られているか？
- [ ] タイトルが「〜で○○を実現する」形式（体言止め or 動詞終止）か？
