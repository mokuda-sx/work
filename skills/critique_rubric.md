# スキル: スライド診断ルーブリック

> **使い方**: `--thumbnail` で生成したPNGを評価する際に読む。通常の生成作業では不要。

---

## 重要: コンテキスト管理ルール（必ず守る）

**サムネイルを全枚一括で読み込んではいけない。**
PNG 1枚あたり大量のトークンを消費するため、全枚読むとコンテキストが枯渇して何もできなくなる。

### 診断セッションの開始手順

```
1. /compact でコンテキストを整理してから診断を開始する
2. まず outline.json を読んで全体構造を把握する（PNG は読まない）
3. スライドを1枚ずつ診断・修正するループに入る
```

---

## ステップ1: アウトライン診断（PNG を読む前に必ず実施）

`slides/YYYYMMDD_プロジェクト名/outline.json` を Read して以下を確認:

### ストーリーライン（タイトル一覧）チェック
スライドの `title` を並べたとき、それだけで話の流れが分かるか？

```
問題例:
  1. 「背景」→ 2. 「課題」→ 3. 「提案」→ ... （タイトルが名詞句のみ）
改善後:
  1. 「属人化で品質がバラつき、月40時間が無駄になっている」
  2. 「AIが中間言語で思考と描画を分離し、品質と速度を両立できる」
```

### スライド構成チェック
- [ ] title（表紙）→ agenda（目次）→ chapter/content... → end の順になっているか
- [ ] content スライドに `subtitle`（キーメッセージ）があるか
- [ ] 大半の content スライドに `objects` か `images` があるか（body のみは数値・ファクト系に限定）
- [ ] chapter スライドが chapter/chapter_photo のどちらかに統一されているか

アウトライン診断で**構成上の問題**を先に潰してから、PNG 診断に進む。

---

## ステップ2: 1枚ずつ PNG 診断ループ

### ループの進め方

```
PNG を1枚 Read → 診断 → 問題があれば Tier 2 JSON を Edit → 次のスライドへ
```

**絶対ルール**:
- 1回のターンで読む PNG は **1枚だけ**
- 修正が発生したら即 Edit → 次のスライドに進む（まとめ修正は禁止）
- 章扉（chapter）スライドは目視のみ（修正の必要はほぼない、次へ進む）

### 各スライドの診断チェックリスト

#### A. 一目瞭然チェック（3秒で判断）
- [ ] 右側や下側に大きな空白の象限がないか → **objects が左偏りのサイン**
- [ ] 「画像挿入位置」プレースホルダーが剥き出しになっていないか → 画像なし生成のサイン
- [ ] ボックスが左端に偏って右半分が空きすぎていないか
- [ ] **未使用プレースホルダーの点線枠が見えていないか** → body が空なら削除すべき（画面表示で目立つ）
- [ ] **objects の横幅がコンテンツエリアの横幅と揃っているか** → スライドを連続表示した時の統一感に直結

#### B. テキスト品質
- [ ] タイトルに「〜により、〇〇を実現する」など動詞・結論が含まれているか（名詞句だけはNG）
- [ ] キーメッセージ（subtitle）が定量的か（「大幅に改善」→「30%削減」）
- [ ] 箇条書きが3〜5項目に収まっているか（6項目以上は過密）

#### B2. フォント整合性（SX Documentation Master 準拠）
- [ ] **同一グループ内のフォントサイズが統一されているか**（最重要）
  - 同じリスト内の項目は全て同じ `font_size` であること
  - 並列カラム内のテキストは全て同じ `font_size` であること
  - 問題例: 箇条書き5項目のうち一部が9pt、他が18pt → 即修正
- [ ] **フォントサイズ階層の目安**:
  - **14pt**: 本文の標準サイズ（読ませるテキスト）
  - **12pt**: 情報密度が高い場合の本文（許容最小の「読ませる」サイズ）
  - **9pt**: 補足・注釈のみ（読む必要が低いが記載しておきたい情報）
  - **9pt未満は原則禁止**（小さすぎて読めない評価になる）
- [ ] 推奨フォント: MSPゴシック（汎用）、游ゴシック（柔らかい）、游ゴシック Medium（見出し）
- [ ] 英字のみの文書以外では Cambria を使わない（和英混在時は日本語フォントで統一）
- [ ] **プロジェクト・資料単位でフォントを統一**しているか（MSPゴシック or 游ゴシック、混在NG）
- [ ] 游ゴシックをタイトルに使う場合は Medium またはボールドにする（線が細く弱く見えるため）

#### C. カラー・コントラスト（SX Documentation Master 準拠）
- [ ] **基本3色**: 白・黒・Dynamic Orange（SXロゴ橙 `ED7D31`）を基調としているか
- [ ] **強調色は Dynamic Orange のみ**。色を追加する場合はテンプレートのカラーパレットから左→右の順に選択
- [ ] グレースケールでの濃淡差が確保されているか（橙を除く差別化はグレースケールで順番に使用）
- [ ] 対比要素（課題 vs 解決）が色で明確に区別されているか
- [ ] 白文字が使われている場合、背景が十分暗いか
- [ ] **キーメッセージを先に決め、そこに色と太さを集中させているか**（色の使い方に意図があるか）

#### D. オブジェクト配置（CRAP 原則）
- [ ] 並列ボックスの `top` が全て揃っているか（Alignment）
- [ ] N個のボックスが均等幅・均等間隔で全幅に配置されているか（Alignment）
- [ ] 同じ役割のボックスは同じ `height`, `font_size` か（Repetition）
- [ ] body（上部）と objects（下部）の間に垂直の空白があるか（Proximity）
- [ ] **オブジェクトはシンプル・フラットに**（影・3D・グラデーション禁止）

#### D2. 図表・チャートの品質
- [ ] チャート・グラフには「**何を伝えたいグラフか**」のメッセージが明記されているか
- [ ] 強調箇所には Dynamic Orange、その他の差別化にはグレースケールを使用しているか
- [ ] 表・グラフもフラットでシンプルなつくりか（過度な装飾・3D・影は禁止）

#### D3. 出典の記載（SX Documentation Master 4/4 準拠）
- [ ] **外部ソースからの引用には必ず出所を明示**（表・グラフ・テキスト・写真すべて）
- [ ] 出典フォーマット:
  - 書籍: `出所：「書名」、頁数、著者名 or 資料名、資料年度`
  - Web: `出所：サイト名、URL、運営者`
- [ ] 出典記載例: `出所：「Pulp and paper towards 2010, an executive summary 1994」URL：https://www.fao.org/faostat/ Food and Agriculture Organization`
- [ ] 引用ルール詳細: https://cms51.sigmaxyz.com/rules-and-guide/information-security/information-security-10/

#### D4. コンフィデンシャルレベル（SX Documentation Master 3/4 準拠）
- [ ] 資料の機密レベルに合わせた適切なマスタースライドが選択されているか
  - **レベル0（公開）**: `Copyright SIGMAXYZ Inc. all rights reserved.`
  - **レベル1（機密）**: `... / Confidential`
  - **レベル1（社外秘）**: `... / Internal Use Only`
  - **レベル2（厳秘）**: `... / Strictly Confidential`
- [ ] フッターのコンフィデンシャル表記と資料の実際の機密レベルが一致しているか

#### E. パターン適合確認
- content スライドで objects と images が混在していないか
- 使われているパターンはA/B/Cのどれか？

| パターン | body | objects | images |
|---|---|---|---|
| A: テキスト+画像 | あり | なし | あり |
| B: テキスト+図解 | あり | あり | なし |
| C: 全幅図解 | なし | あり | なし |

---

## ステップ3: 優先度付き修正判断

問題を発見したら、以下の優先度で修正するかスキップするかを決める:

| 優先度 | 症状 | 対応 |
|---|---|---|
| **S（即修正）** | objects が左端に偏り右半分が空白、3要素共存で崩壊、**同一グループ内でフォントサイズが不統一** | その場で Tier 2 Edit |
| **A（修正推奨）** | タイトルが名詞句のみ、keyメッセージが定性的 | Tier 2 Edit |
| **B（余裕があれば）** | 箇条書きが1項目多い、フォントサイズ微調整 | 後回し可 |
| **C（許容）** | 章扉にアクセント画像がない、余白がやや広い | スキップ |

---

## ステップ4: 修正後の再結合

問題スライドを Edit したら再結合してサムネイルを更新:

```bash
python generate_pptx.py --assemble-only --project "<プロジェクト名>" --thumbnail
```

修正したスライドのサムネイルだけ再確認（全スライドを読み直さない）。

---

## 診断レポートの出力形式（簡潔版）

```
## スライド X 診断

- **パターン**: C（テキスト+図解）
- **問題**: objects 3ボックスが left: 0.5〜5.9 に偏り、右に4インチの空白
- **修正**: left を 0.5 / 4.7 / 8.9 に修正（全幅3カード、width=3.9）
- **優先度**: S（即修正）
```

全スライドを通じた全体コメントは最後に1段落でまとめる（長い報告書は不要）。

---

## スライドタイプ別クイック判断

| type | 確認ポイント | ほぼOKの判断基準 |
|---|---|---|
| `title` | 画像プレースホルダーが出ていないか | タイトル+サブタイトルが読める |
| `agenda` | 章番号+章名だけか（詳細を書きすぎていないか） | 5項目以内 |
| `chapter` | タイトルだけで力強いか | 10文字前後でOK、次へ進む |
| `content` | パターンA/B/Cのどれか、objects偏りがないか | 上記チェックリストで確認 |
| `end` | 画像が生成されているか | 「ご確認ありがとう」系テキストが読める |
